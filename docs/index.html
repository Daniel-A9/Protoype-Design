<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="google" content="notranslate">
    <title>LocalMarket</title>
    <link href="style.css" rel="stylesheet">
  </head>
  <body>

    <!-- Fixed Top Header -->
    <div class="top-header">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <img src="text.png" alt="Local Market Wordmark" loading="lazy" style="height: 40px; filter: var(--wordmark-filter);">
      </div>
      <nav class="header-nav">
        <a href="home/index.html" class="link" data-testid="desktop-nav-home">Home</a>
        <a href="index.html" class="link" data-testid="desktop-nav-discovery">Discover</a>
        <a href="discussions/categories/local-discussions/" class="link" data-testid="desktop-nav-community">Community</a>
        <a href="cart/index.html" class="link" data-testid="desktop-nav-cart">
          <i>shopping_cart</i>
          <span>Cart</span>
        </a>
      </nav>
      <!-- Right side: Logo and hamburger menu -->
      <div class="header-right">
        <!-- Site Logo -->
        <a href="index.html" class="site-logo">
          <img src="Logo 333.png" alt="LocalMarket Logo">
        </a>
        <a href="userprofile/index.html" class="header-profile" data-testid="desktop-nav-profile">
          <img src="https://images.unsplash.com/photo-1608270586620-248524c67de9?w=60&h=60&fit=crop" alt="Profile" loading="lazy" class="circle small">
        </a>
        <!-- Search Feed Hamburger Menu -->
        <div class="feed-menu-btn" style="position: relative;" onclick="document.getElementById('searchFeedMenu').classList.toggle('active')">
          <i>menu</i>
          <div class="feed-menu-dropdown" id="searchFeedMenu">
            <a href="#" onclick="event.preventDefault(); document.getElementById('searchFeedMenu').classList.remove('active');">Search Settings</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Desktop Top Navigation -->
    <nav class="top desktop-nav" style="display: none;">
      <div class="container">
        <div class="row no-gap">
          <div class="col s12">
            <div class="nav-content">
              <div class="nav-logo">
                <h4 class="brand-title">LocalMarket</h4>
                <div class="logo-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="#F59E0B"/>
                    <path d="M12 6L12.5 8.5L15 9L12.5 9.5L12 12L11.5 9.5L9 9L11.5 8.5L12 6Z" fill="#FCD34D"/>
                  </svg>
                </div>
              </div>
              <div class="nav-links">
                <a href="home/index.html" class="nav-link" data-testid="nav-home"><i>home</i></a>
                <a href="/" class="nav-link" data-testid="nav-search"><i>search</i></a>
                <a href="discussions/forums/" class="nav-link" data-testid="nav-discussions"><i>groups</i></a>
                <a href="cart/index.html" class="nav-link" data-testid="nav-cart"><i>shopping_cart</i></a>
                <a href="userprofile/index.html" class="nav-link" data-testid="nav-profile"><i>person</i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="home/index.html" class="nav-item" data-testid="mobile-nav-home">
        <i>home</i>
      </a>
      <a href="index.html" class="nav-item active" data-testid="mobile-nav-search">
        <i>search</i>
      </a>
      <a href="discussions/categories/local-discussions/" class="nav-item" data-testid="mobile-nav-discussions">
        <i>groups</i>
      </a>
      <a href="cart/index.html" class="nav-item" data-testid="mobile-nav-cart">
        <i>shopping_cart</i>
      </a>
      <a href="userprofile/index.html" class="nav-item" data-testid="mobile-nav-profile">
        <i>person</i>
      </a>
    </nav>

    <main class="responsive" style="height: calc(100vh - 52px); overflow-y: auto;">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <!-- Header Section -->
            <div class="header-section">
              <div class="search-bar">
                <div class="search-input-container">
                  <i class="material-icons location-pin-icon">location_on</i>
                  <input type="text" value="15235" class="zip-input" data-testid="zip-input">
                  <div class="input-divider"></div>
                  <input type="text" placeholder="Search near me" class="search-input" data-testid="search-input">
                </div>
                <button class="filter-toggle-btn" onclick="document.getElementById('filterDropdown').classList.toggle('show')" data-testid="filter-btn">
                  <i class="material-icons">tune</i>
                </button>
              </div>
              
              <div id="filterDropdown" class="filter-dropdown-menu">
                <select class="filter-dropdown" data-testid="type-filter">
                  <option>VENDORS, EVENTS</option>
                  <option>VENDORS</option>
                  <option>EVENTS</option>
                </select>
                <span class="filter-connector">in</span>
                <select class="filter-dropdown" data-testid="distance-filter">
                  <option>1000 miles</option>
                  <option>500 miles</option>
                  <option>100 miles</option>
                  <option>50 miles</option>
                  <option>25 miles</option>
                </select>
              </div>
            </div>
            
            <div class="feed-container">
              
              <!-- Card 1: Brewery Central -->
              <div class="card small clickable-card" onclick="window.location.href='vendors/brewery/index.html'" data-testid="brewery-card" data-desktop-layout="brewery">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Brewery</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive" loading="lazy">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Brewery Central</h5>
                    <div class="card-location">
                      <span class="location">12345</span>
                      <span class="location-detail">Pittsburgh, PA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Crafting exceptional, small-batch beers since 2015, we're dedicated to quality, creativity, and community. Stop by our taproom to enjoy fresh pours straight from the source and explore our brewery with guided tours!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 2: Farmer -->
              <div class="card small clickable-card" onclick="window.location.href='vendors/sunny-acres/index.html'" data-testid="farm-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Small Farm</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=400&h=300&fit=crop" class="responsive" loading="lazy">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Sunny Acres Farm</h5>
                    <div class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Fresh organic vegetables, free-range eggs, and seasonal fruitsâ€”all grown with care using sustainable farming practices. Visit our charming farm stand to pick up the latest harvest, or join our CSA program for weekly boxes filled with the very best of the season!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 2: Artisan -->
              <div class="card small clickable-card" onclick="window.location.href='vendors/mountain-pottery/index.html'" data-testid="pottery-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Artisan</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1523475472560-d2df97ec485c?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Artist painting detailed designs onto a handcrafted ceramic vase">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Mountain Pottery Studio</h5>
                    <div class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Handcrafted ceramic pieces made with locally sourced clay, each created with care and attention to detail. Custom orders are always welcome! Visit our studio to browse our latest work and take part in our pottery classes and hands-on workshops.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 3: Event -->
              <div class="card small clickable-card" onclick="window.location.href='events/summer-music-festival/index.html'" data-testid="music-festival-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Music Festival</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=300&fit=crop" class="responsive" loading="lazy">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Summer Music Festival</h5>
                    <div class="card-location">
                      <span class="location">03894</span>
                      <span class="location-detail">Austin, TX</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Three days of local bands, food trucks, and artisan vendors. Family-friendly activities and live music all weekend long!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 4: Beer Tasting Event -->
              <div class="card small clickable-card" onclick="window.location.href='events/beer/index.html'" data-testid="beer-event-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Beer Tasting</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Craft Beer Tasting Event</h5>
                    <div class="card-location">
                      <span class="location">12345</span>
                      <span class="location-detail">Pittsburgh, PA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Join us for an exclusive craft beer tasting featuring local breweries. Sample unique brews, meet the brewers, and enjoy live music!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 5: Craftsman -->
              <div class="card small" data-testid="woodworks-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Craftsmen</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Riverside Woodworks</h5>
                    <div class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Custom furniture and home decor made from reclaimed wood. Each piece tells a story of local history and craftsmanship.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 5: Class -->
              <div class="card small" data-testid="cooking-class-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Class</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Farm-to-Table Cooking Class</h5>
                    <div class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Learn to cook with fresh, local ingredients! Chef Maria will teach you seasonal recipes using produce from nearby farms.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 6: Farmer -->
              <div class="card small" data-testid="apiary-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Small Farm</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Honey Hill Apiary</h5>
                    <div class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Raw, unfiltered honey from our local bee colonies. Also offering beekeeping classes and hive tours for the whole family!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 7: Fair -->
              <div class="card small" data-testid="craft-fair-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Craft Fair</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">County Craft Fair</h5>
                    <div class="card-location">
                      <span class="location">03894</span>
                      <span class="location-detail">Austin, TX</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Over 50 local artisans showcasing handmade goods, jewelry, pottery, textiles, and more. Food trucks and live demonstrations!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 8: Artisan -->
              <div class="card small" data-testid="jewelry-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Artisan</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Silver Moon Jewelry</h5>
                    <div class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Handcrafted sterling silver jewelry inspired by nature. Custom pieces available. Visit our studio or shop online!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 9: Farmer -->
              <div class="card small" data-testid="organic-farm-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Small Farm</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Green Valley Organic Farm</h5>
                    <div class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Certified organic vegetables, herbs, and flowers. Pick-your-own berries in season. Farm tours available by appointment.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 10: Class -->
              <div class="card small" data-testid="woodworking-class-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Workshop</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Beginner Woodworking Workshop</h5>
                    <div class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Learn basic woodworking skills and create your own cutting board! All tools and materials provided. Perfect for beginners.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 11: Artisan -->
              <div class="card small" data-testid="textiles-card">
                <div class="card-header-row">
                  <span class="type-badge vendor">VENDOR</span>
                  <span class="subcategory-tag">Artisan</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Heritage Textiles</h5>
                    <div class="card-location">
                      <span class="location">03894</span>
                      <span class="location-detail">Austin, TX</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Handwoven textiles using traditional techniques. Scarves, blankets, and home decor items. Custom orders welcome!</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

              <!-- Card 12: Event -->
              <div class="card small" data-testid="farmers-market-card">
                <div class="card-header-row">
                  <span class="type-badge event">EVENT</span>
                  <span class="subcategory-tag">Market</span>
                </div>
                <div class="card-image">
                  <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=300&fit=crop" class="responsive">
                </div>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h5 class="card-title">Farmers Market Opening Day</h5>
                    <div class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </div>
                  </div>
                  <button class="follow-btn">Follow</button>
                </div>
                <div class="card-divider"></div>
                <div class="card-content">
                  <p>Join us for the opening day of our weekly farmers market! Fresh produce, local vendors, live music, and family activities.</p>
                </div>
                
                <!-- Comments Section -->
                <div class="comments-section" style="display: none;">
                  <!-- Comments loaded via htmx -->
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </main>

    <script type="module" src="https://cdn.jsdelivr.net/npm/beercss@3.12.13/dist/cdn/beer.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/material-dynamic-colors@1.1.2/dist/cdn/material-dynamic-colors.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
      // Theme Toggle Functionality
      (function() {
        // Get stored theme or default to light
        const storedTheme = localStorage.getItem('theme') || 'light';
        
        // Apply theme on page load
        document.body.classList.remove('dark', 'light');
        document.body.classList.add(storedTheme);
        
        // Create toggle button
        const toggleButton = document.createElement('button');
        toggleButton.className = 'theme-toggle circle';
        toggleButton.setAttribute('aria-label', 'Toggle theme');
        toggleButton.innerHTML = '<i>' + (storedTheme === 'light' ? 'dark_mode' : 'light_mode') + '</i>';
        
        // Add click handler
        toggleButton.addEventListener('click', function() {
          const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          
          document.body.classList.remove('dark', 'light');
          document.body.classList.add(newTheme);
          localStorage.setItem('theme', newTheme);
          
          toggleButton.querySelector('i').textContent = newTheme === 'light' ? 'dark_mode' : 'light_mode';
        });
        
        document.body.appendChild(toggleButton);
      })();
      
      // Toggle comments visibility (client-side only)
      document.addEventListener('click', function(e) {
        if (e.target.closest('.clickable-container') && e.target.closest('.clickable-container').querySelector('.comment-text')) {
          const container = e.target.closest('.clickable-container');
          const postCard = container.closest('.card');
          const commentsSection = postCard.querySelector('.comments-section');
          const commentText = container.querySelector('.comment-text');
          
          if (commentsSection.style.display === 'none' || commentsSection.style.display === '') {
            commentsSection.style.display = 'block';
            commentText.textContent = 'Hide Comments';
          } else {
            commentsSection.style.display = 'none';
            commentText.textContent = 'Comment';
          }
        }
      });
      
      // Move card elements to match brewery card layout on desktop
      function rearrangeCardLayout() {
        if (window.innerWidth < 769) {
          // Reset on mobile
          document.querySelectorAll('.feed-container .card.small:not([data-desktop-layout="brewery"])').forEach(card => {
            delete card.dataset.rearranged;
            const titleClone = card.querySelector('.card-header-row .card-title');
            if (titleClone) titleClone.remove();
            const titleEl = card.querySelector('.card-header-actions .card-title');
            if (titleEl) titleEl.style.display = '';
          });
          return;
        }
        
        const cards = document.querySelectorAll('.feed-container .card.small:not([data-desktop-layout="brewery"])');
        cards.forEach(card => {
          if (card.dataset.rearranged) return; // Already rearranged
          
          const headerRow = card.querySelector('.card-header-row');
          const titleEl = card.querySelector('.card-title');
          const typeBadge = card.querySelector('.type-badge');
          const subcategoryTag = card.querySelector('.subcategory-tag');
          
          if (headerRow && titleEl && !headerRow.querySelector('.card-title')) {
            // Clone title and move to header row
            const titleClone = titleEl.cloneNode(true);
            headerRow.insertBefore(titleClone, headerRow.firstChild);
          }
          
          // Hide original title in title section
          if (titleEl) titleEl.style.display = 'none';
          
          // Move type badge and subcategory to right side of header row
          if (headerRow && typeBadge && subcategoryTag) {
            const typeContainer = document.createElement('span');
            typeContainer.style.fontSize = '0.8rem';
            typeContainer.style.color = 'var(--on-surface-variant)';
            typeContainer.textContent = typeBadge.textContent.trim() + ' ' + subcategoryTag.textContent.trim();
            headerRow.appendChild(typeContainer);
          }
          
          card.dataset.rearranged = 'true';
        });
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', rearrangeCardLayout);
      } else {
        rearrangeCardLayout();
      }
      
      window.addEventListener('resize', rearrangeCardLayout);
      
      // Hide header and logo when scrolling down
      (function() {
        let lastScrollTop = 0;
        const scrollThreshold = 10; // Minimum scroll distance to trigger hide/show
        const topHeader = document.querySelector('.top-header');
        const siteLogo = document.querySelector('.site-logo');
        const mainContent = document.querySelector('main.responsive') || document.querySelector('main');
        
        let ticking = false;
        
        function handleScroll() {
          const scrollTop = mainContent ? mainContent.scrollTop : (window.pageYOffset || document.documentElement.scrollTop);
          
          if (Math.abs(lastScrollTop - scrollTop) < scrollThreshold) {
            ticking = false;
            return;
          }
          
          if (scrollTop > lastScrollTop && scrollTop > scrollThreshold) {
            // Scrolling down - hide header and logo
            if (topHeader) topHeader.classList.add('header-hidden');
            if (siteLogo) siteLogo.classList.add('logo-hidden');
          } else if (scrollTop < lastScrollTop) {
            // Scrolling up - show header and logo
            if (topHeader) topHeader.classList.remove('header-hidden');
            if (siteLogo) siteLogo.classList.remove('logo-hidden');
          }
          
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; // For mobile or negative scroll
          ticking = false;
        }
        
        function onScroll() {
          if (!ticking) {
            window.requestAnimationFrame(handleScroll);
            ticking = true;
          }
        }
        
        // Listen to scroll events on main content or window
        if (mainContent) {
          mainContent.addEventListener('scroll', onScroll, { passive: true });
        }
        window.addEventListener('scroll', onScroll, { passive: true });
      })();
    </script>
  </body>
</html>
