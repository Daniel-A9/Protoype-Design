<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="google" content="notranslate">
    <title>Shopping Cart - LocalMarket</title>
    <link href="../style.css" rel="stylesheet">
  </head>
  <body class="dark">

    <header class="top-header">
      <div class="header-wordmark">
        <img src="../text.png" alt="Local Market Wordmark" loading="lazy" class="wordmark-img">
      </div>
      <nav class="header-nav" aria-label="Main navigation">
        <a href="../home/" class="link" data-testid="desktop-nav-home">Home</a>
        <a href="../" class="link" data-testid="desktop-nav-discovery">Discover</a>
        <a href="../discussions/categories/local-discussions/" class="link" data-testid="desktop-nav-community">Community</a>
        <a href="../cart/" class="link" data-testid="desktop-nav-cart">
          <i>shopping_cart</i>
          <span>Cart</span>
        </a>
      </nav>
      <div class="header-right">
        <a href="../" class="site-logo">
          <img src="../Logo 333.png" alt="LocalMarket Logo" loading="lazy">
        </a>
        <a href="../userprofile/" class="header-profile" data-testid="desktop-nav-profile" aria-label="User profile">
          <img src="https://images.unsplash.com/photo-1608270586620-248524c67de9?w=60&h=60&fit=crop" alt="Profile" loading="lazy" class="circle small">
        </a>
        <button type="button" class="feed-menu-btn" aria-label="Cart menu" aria-expanded="false" aria-controls="cartMenu">
          <i>menu</i>
          <menu class="feed-menu-dropdown" id="cartMenu" role="menu">
            <li role="menuitem">
              <a href="#" class="menu-item">Cart Settings</a>
            </li>
          </menu>
        </button>
      </div>
    </header>

    <nav class="bottom-nav">
      <a href="../home/" class="nav-item" data-testid="nav-home">
        <i>home</i>
      </a>
      <a href="../" class="nav-item" data-testid="nav-search">
        <i>search</i>
      </a>
      <a href="../discussions/categories/local-discussions/" class="nav-item" data-testid="nav-discussions">
        <i>groups</i>
      </a>
      <a href="../cart/" class="nav-item active" data-testid="nav-cart">
        <i>shopping_cart</i>
      </a>
      <a href="../userprofile/" class="nav-item" data-testid="nav-profile">
        <i>person</i>
      </a>
    </nav>

    <main class="responsive bottom-padding">
      <section>
        <div class="container auto-margin padding-top-small max-width-large">
          <div class="row">
            <div class="col s12">
              <div class="row middle-align space-between margin-bottom-small">
                <h2 class="no-margin">Cart</h2>
                <a href="#" class="link" data-testid="header-edit-cart" onclick="toggleCartEdit(event)">Edit Cart</a>
              </div>
              
              <h6 class="margin-top-small margin-bottom-tiny small-text bold text-grey">Brewery Central</h6>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('brewery-central')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1608270586620-248524c67de9?w=100&h=100&fit=crop" alt="Citrus IPA" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Citrus IPA</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Pending Acceptance</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$8.99</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="brewery-central-citrus" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('brewery-central')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=100&h=100&fit=crop" alt="Chocolate Stout" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Chocolate Stout</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Awaiting Payment</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$9.99</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="brewery-central-chocolate" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('brewery-central')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1581636625402-29b2a704ef13?w=100&h=100&fit=crop" alt="Golden Lager" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Golden Lager</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Processing</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$7.99</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="brewery-central-golden" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <div class="row middle-align margin-vertical-tiny horizontal-padding-medium">
                <div class="tiny-width margin-right-small"></div>
                <div class="max row space-between middle-align">
                  <span class="small-text bold text-grey">Paypal</span>
                  <div class="row middle-align small-space">
                    <div class="tiny-width"></div>
                    <div class="tiny-width right-align small-text bold">$26.97</div>
                  </div>
                </div>
              </div>
              
              <h6 class="margin-top-small margin-bottom-tiny small-text bold text-grey">Farm Fresh Produce</h6>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('farm-fresh')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=100&h=100&fit=crop" alt="Organic Tomatoes" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Organic Tomatoes</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Shipped</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$4.99</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="farm-fresh-tomatoes" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('farm-fresh')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=100&h=100&fit=crop" alt="Fresh Carrots" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Fresh Carrots</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Processing</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$3.49</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="farm-fresh-carrots" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <div class="row middle-align margin-vertical-tiny horizontal-padding-medium">
                <div class="tiny-width margin-right-small"></div>
                <div class="max row space-between middle-align">
                  <span class="small-text bold text-grey">Cash on Pick-up</span>
                  <div class="row middle-align small-space">
                    <div class="tiny-width"></div>
                    <div class="tiny-width right-align small-text bold">$8.48</div>
                  </div>
                </div>
              </div>
              
              <h6 class="margin-top-small margin-bottom-tiny small-text bold text-grey">Artisan Bread Co.</h6>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('artisan-bread')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1516594798947-e65505dbb29d?w=100&h=100&fit=crop" alt="Sourdough Bread" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Sourdough Bread</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Awaiting Payment</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$6.99</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="artisan-bread-sourdough" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <article class="no-padding small-margin margin-bottom-tiny" onclick="openPurchaseModal('artisan-bread')">
                <header class="padding-small horizontal-padding-medium">
                  <div class="row no-gap middle-align">
                    <div class="tiny-width tiny-height no-shrink margin-right-small">
                      <img src="https://images.unsplash.com/photo-1571613316887-6f8d5cbf7ef7?w=100&h=100&fit=crop" alt="Rye Bread" loading="lazy" class="tiny round">
                    </div>
                    <div class="max min-width-0 row middle-align small-space overflow-hidden">
                      <div class="max min-width-0 overflow-hidden text-ellipsis no-wrap">
                        <span class="bold">Rye Bread</span>
                      </div>
                      <div class="tiny-width center-align small-text overflow-hidden text-ellipsis no-wrap">
                        <span>Pending Acceptance</span>
                      </div>
                      <div class="tiny-width right-align small-text">
                        <span>$7.49</span>
                      </div>
                    </div>
                    <button class="circle transparent small margin-left-auto" data-cart-remove="artisan-bread-rye" style="display: none;">
                      <i>close</i>
                    </button>
                  </div>
                </header>
              </article>
              
              <div class="row middle-align margin-vertical-tiny horizontal-padding-medium">
                <div class="tiny-width margin-right-small"></div>
                <div class="max row space-between middle-align">
                  <span class="small-text bold text-grey">Stripe</span>
                  <div class="row middle-align small-space">
                    <div class="tiny-width"></div>
                    <div class="tiny-width right-align small-text bold">$14.48</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <dialog id="purchase-modal" class="modal medium">
      <div class="padding-medium horizontal-padding-large max-width-medium responsive-width">
        <div class="row space-between top-align margin-bottom-small padding-top-medium">
          <div>
            <h5 id="modal-vendor-name" class="underline no-margin">Complete Purchase</h5>
            <div class="small-text margin-top-tiny text-grey">Checkout</div>
          </div>
          <button class="circle transparent" onclick="closePurchaseModal()">
            <i>close</i>
          </button>
        </div>
        <div id="modal-products" class="margin-bottom-small">
        </div>
        <hr class="margin-vertical-small">
        <div class="row space-between middle-align margin-bottom-medium">
          <span class="bold">Total:</span>
          <span id="modal-total" class="bold large-text right-align">$0.00</span>
        </div>
        <div class="row space-between middle-align margin-bottom-small">
          <span class="medium-text">Payment Method:</span>
          <div>
            <button class="row middle-align small-space padding-medium surface-container-high round small-text border-none" data-ui="#payment-method-menu">
              <i class="small">edit</i>
              <span id="modal-payment-method" class="right-align">Paypal</span>
              <menu id="payment-method-menu" class="right min-width-medium">
                <li><a href="#" data-payment="Paypal" onclick="selectPaymentMethod(event, 'Paypal')">Paypal</a></li>
                <li><a href="#" data-payment="Venmo" onclick="selectPaymentMethod(event, 'Venmo')">Venmo</a></li>
                <li><a href="#" data-payment="Stripe" onclick="selectPaymentMethod(event, 'Stripe')">Stripe</a></li>
              </menu>
            </button>
          </div>
        </div>
        <nav class="row small-space">
          <button class="btn outline max" onclick="closePurchaseModal()">Cancel</button>
          <button class="btn primary max" onclick="completePurchase()">
            <i>check</i>
            <span>Complete Purchase</span>
          </button>
        </nav>
      </div>
    </dialog>

    <script type="module" src="https://cdn.jsdelivr.net/npm/beercss@3.12.13/dist/cdn/beer.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/material-dynamic-colors@1.1.2/dist/cdn/material-dynamic-colors.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
      (function() {
        const storedTheme = localStorage.getItem('theme') || 'light';
        document.body.classList.remove('dark', 'light');
        document.body.classList.add(storedTheme);
        const toggleButton = document.createElement('button');
        toggleButton.className = 'theme-toggle circle';
        toggleButton.setAttribute('aria-label', 'Toggle theme');
        toggleButton.innerHTML = '<i>' + (storedTheme === 'light' ? 'dark_mode' : 'light_mode') + '</i>';
        toggleButton.addEventListener('click', function() {
          const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          document.body.classList.remove('dark', 'light');
          document.body.classList.add(newTheme);
          localStorage.setItem('theme', newTheme);
          toggleButton.querySelector('i').textContent = newTheme === 'light' ? 'dark_mode' : 'light_mode';
        });
        document.body.appendChild(toggleButton);
      })();
      
      (function() {
        let lastScrollTop = 0;
        const scrollThreshold = 10;
        const topHeader = document.querySelector('.top-header');
        const siteLogo = document.querySelector('.site-logo');
        const mainContent = document.querySelector('main.responsive') || document.querySelector('main');
        
        let ticking = false;
        
        function handleScroll() {
          const scrollTop = mainContent ? mainContent.scrollTop : (window.pageYOffset || document.documentElement.scrollTop);
          
          if (Math.abs(lastScrollTop - scrollTop) < scrollThreshold) {
            ticking = false;
            return;
          }
          
          if (scrollTop > lastScrollTop && scrollTop > scrollThreshold) {
            if (topHeader) topHeader.classList.add('header-hidden');
            if (siteLogo) siteLogo.classList.add('logo-hidden');
          } else if (scrollTop < lastScrollTop) {
            if (topHeader) topHeader.classList.remove('header-hidden');
            if (siteLogo) siteLogo.classList.remove('logo-hidden');
          }
          
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
          ticking = false;
        }
        
        function onScroll() {
          if (!ticking) {
            window.requestAnimationFrame(handleScroll);
            ticking = true;
          }
        }
        
        if (mainContent) {
          mainContent.addEventListener('scroll', onScroll, { passive: true });
        }
        window.addEventListener('scroll', onScroll, { passive: true });
      })();

      const vendorData = {
        'brewery-central': {
          name: 'Brewery Central',
          products: [
            { name: 'Citrus IPA', price: 8.99, image: 'https://images.unsplash.com/photo-1608270586620-248524c67de9?w=100&h=100&fit=crop' },
            { name: 'Chocolate Stout', price: 9.99, image: 'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=100&h=100&fit=crop' },
            { name: 'Golden Lager', price: 7.99, image: 'https://images.unsplash.com/photo-1581636625402-29b2a704ef13?w=100&h=100&fit=crop' }
          ],
          paymentMethod: 'Paypal'
        },
        'farm-fresh': {
          name: 'Farm Fresh Produce',
          products: [
            { name: 'Organic Tomatoes', price: 4.99, image: 'https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=100&h=100&fit=crop' },
            { name: 'Fresh Carrots', price: 3.49, image: 'https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=100&h=100&fit=crop' }
          ],
          paymentMethod: 'Cash on Pick-up'
        },
        'artisan-bread': {
          name: 'Artisan Bread Co.',
          products: [
            { name: 'Sourdough Bread', price: 6.99, image: 'https://images.unsplash.com/photo-1516594798947-e65505dbb29d?w=100&h=100&fit=crop' },
            { name: 'Rye Bread', price: 7.49, image: 'https://images.unsplash.com/photo-1571613316887-6f8d5cbf7ef7?w=100&h=100&fit=crop' }
          ],
          paymentMethod: 'Stripe'
        }
      };

      let isCartEditing = false;

      function toggleCartEdit(event) {
        if (event) {
          event.preventDefault();
        }
        isCartEditing = !isCartEditing;
        document.body.classList.toggle('cart-editing', isCartEditing);
        const editLink = document.querySelector('[data-testid="header-edit-cart"]');
        if (editLink) {
          editLink.textContent = isCartEditing ? 'Done' : 'Edit Cart';
        }
        const editButtons = document.querySelectorAll('[data-cart-remove]');
        editButtons.forEach((button) => {
          button.style.display = isCartEditing ? 'inline-flex' : 'none';
        });
      }

      function openPurchaseModal(vendorKey) {
        const vendor = vendorData[vendorKey];
        if (!vendor) return;

        const modal = document.getElementById('purchase-modal');
        const vendorNameEl = document.getElementById('modal-vendor-name');
        const productsEl = document.getElementById('modal-products');
        const totalEl = document.getElementById('modal-total');
        const paymentMethodEl = document.getElementById('modal-payment-method');

        vendorNameEl.textContent = vendor.name;
        if (paymentMethodEl) {
          paymentMethodEl.textContent = vendor.paymentMethod;
        }

        let total = 0;
        productsEl.innerHTML = '';
        vendor.products.forEach((product, index) => {
          total += product.price;
          const productDiv = document.createElement('div');
          productDiv.className = 'row top-align small-space padding-vertical-medium';
          productDiv.innerHTML = `
            <img src="${product.image}" class="small round no-shrink" loading="lazy" />
            <div class="max">
              <div class="bold margin-bottom-tiny">${product.name}</div>
              <div class="small-text text-grey right-align">$${product.price.toFixed(2)}</div>
            </div>
          `;
          productsEl.appendChild(productDiv);
          
          if (index < vendor.products.length - 1) {
            const divider = document.createElement('hr');
            divider.className = 'margin-vertical-tiny';
            productsEl.appendChild(divider);
          }
        });

        totalEl.textContent = '$' + total.toFixed(2);

        modal.classList.add('active');
        modal.showModal();
      }

      function closePurchaseModal() {
        const modal = document.getElementById('purchase-modal');
        modal.classList.remove('active');
        modal.close();
      }

      function completePurchase() {
        alert('Purchase completed successfully!');
        closePurchaseModal();
      }

      document.getElementById('purchase-modal').addEventListener('click', function(e) {
        if (e.target === this) {
          closePurchaseModal();
        }
      });

      function selectPaymentMethod(event, method) {
        event.preventDefault();
        const paymentMethodEl = document.getElementById('modal-payment-method');
        if (paymentMethodEl) {
          paymentMethodEl.textContent = method;
        }
        
        if (typeof ui !== 'undefined') {
          ui('#payment-method-menu');
        } else {
          const menu = document.getElementById('payment-method-menu');
          if (menu) {
            menu.classList.remove('active');
          }
        }
      }
    </script>
  </body>
</html>
