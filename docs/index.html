<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="google" content="notranslate">
    <title>LocalMarket</title>
    <link href="style.css" rel="stylesheet">
  </head>
  <body>

    <!-- Fixed Top Header -->
    <header class="top-header">
      <div class="header-wordmark">
        <img src="text.png" alt="Local Market Wordmark" loading="lazy" class="wordmark-img">
      </div>
      <nav class="header-nav" aria-label="Main navigation">
        <a href="home/index.html" class="link" data-testid="desktop-nav-home">Home</a>
        <a href="index.html" class="link" data-testid="desktop-nav-discovery">Discover</a>
        <a href="discussions/categories/local-discussions/index.html" class="link" data-testid="desktop-nav-community">Community</a>
        <a href="cart/index.html" class="link" data-testid="desktop-nav-cart">
          <i>shopping_cart</i>
          <span>Cart</span>
        </a>
      </nav>
      <!-- Right side: Logo and hamburger menu -->
      <div class="header-right">
        <!-- Site Logo -->
        <a href="index.html" class="site-logo">
          <img src="Logo 333.png" alt="LocalMarket Logo" loading="lazy">
        </a>
        <a href="userprofile/index.html" class="header-profile" data-testid="desktop-nav-profile" aria-label="User profile">
          <img src="https://images.unsplash.com/photo-1608270586620-248524c67de9?w=60&h=60&fit=crop" alt="Profile" loading="lazy" class="circle small">
        </a>
        <!-- Search Feed Hamburger Menu -->
        <button type="button" class="feed-menu-btn" aria-label="Search settings menu" aria-expanded="false" aria-controls="searchFeedMenu">
          <i>menu</i>
          <menu class="feed-menu-dropdown" id="searchFeedMenu" role="menu">
            <li role="menuitem">
              <a href="#" class="menu-item">Search Settings</a>
            </li>
          </menu>
        </button>
      </div>
    </header>

    <!-- Desktop Top Navigation -->
    <nav class="top desktop-nav" aria-label="Desktop navigation" hidden>
      <div class="container">
        <div class="row no-gap">
          <div class="col s12">
            <div class="nav-content">
              <div class="nav-logo">
                <h4 class="brand-title">LocalMarket</h4>
                <div class="logo-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="#F59E0B"/>
                    <path d="M12 6L12.5 8.5L15 9L12.5 9.5L12 12L11.5 9.5L9 9L11.5 8.5L12 6Z" fill="#FCD34D"/>
                  </svg>
                </div>
              </div>
              <div class="nav-links">
                <a href="home/index.html" class="nav-link" data-testid="nav-home"><i>home</i></a>
                <a href="index.html" class="nav-link" data-testid="nav-search"><i>search</i></a>
                <a href="discussions/categories/local-discussions/index.html" class="nav-link" data-testid="nav-discussions"><i>groups</i></a>
                <a href="cart/index.html" class="nav-link" data-testid="nav-cart"><i>shopping_cart</i></a>
                <a href="userprofile/index.html" class="nav-link" data-testid="nav-profile"><i>person</i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="home/index.html" class="nav-item" data-testid="mobile-nav-home">
        <i>home</i>
      </a>
      <a href="index.html" class="nav-item active" data-testid="mobile-nav-search">
        <i>search</i>
      </a>
      <a href="discussions/categories/local-discussions/index.html" class="nav-item" data-testid="mobile-nav-discussions">
        <i>groups</i>
      </a>
      <a href="cart/index.html" class="nav-item" data-testid="mobile-nav-cart">
        <i>shopping_cart</i>
      </a>
      <a href="userprofile/index.html" class="nav-item" data-testid="mobile-nav-profile">
        <i>person</i>
      </a>
    </nav>

    <main class="responsive main-content">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <!-- Search Section -->
            <section class="header-section" aria-label="Search and filters">
              <form class="search-form" role="search">
                <div class="search-bar">
                  <div class="search-input-container">
                    <label for="zip-input" class="visually-hidden">Zip code</label>
                    <i class="material-icons location-pin-icon" aria-hidden="true">location_on</i>
                    <input type="text" id="zip-input" value="15235" class="zip-input" data-testid="zip-input" aria-label="Zip code">
                    <div class="input-divider" aria-hidden="true"></div>
                    <label for="search-input" class="visually-hidden">Search</label>
                    <input type="search" id="search-input" placeholder="Search near me" class="search-input" data-testid="search-input" aria-label="Search">
                  </div>
                  <button type="button" class="filter-toggle-btn" aria-label="Toggle filters" aria-expanded="false" aria-controls="filterDropdown" data-testid="filter-btn">
                    <i class="material-icons" aria-hidden="true">tune</i>
                  </button>
                </div>
                
                <fieldset id="filterDropdown" class="filter-dropdown-menu">
                  <legend class="visually-hidden">Filter options</legend>
                  <label for="type-filter" class="visually-hidden">Filter by type</label>
                  <select id="type-filter" class="filter-dropdown" data-testid="type-filter" aria-label="Filter by type">
                    <option>VENDORS, EVENTS</option>
                    <option>VENDORS</option>
                    <option>EVENTS</option>
                  </select>
                  <span class="filter-connector" aria-hidden="true">in</span>
                  <label for="distance-filter" class="visually-hidden">Filter by distance</label>
                  <select id="distance-filter" class="filter-dropdown" data-testid="distance-filter" aria-label="Filter by distance">
                    <option>1000 miles</option>
                    <option>500 miles</option>
                    <option>100 miles</option>
                    <option>50 miles</option>
                    <option>25 miles</option>
                  </select>
                </fieldset>
              </form>
            </section>
            
            <section class="feed-container" aria-label="Vendors and events feed">
              
              <!-- Card 1: Brewery Central -->
              <article class="card small clickable-card" data-testid="brewery-card" data-desktop-layout="brewery">
                <a href="vendors/brewery/index.html" class="card-link" aria-label="View Brewery Central">
                  <header class="card-header-row">
                    <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                    <span class="subcategory-tag">Brewery</span>
                  </header>
                  <figure class="card-image">
                    <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Brewery Central taproom">
                  </figure>
                  <div class="card-header-actions">
                    <div class="card-title-section">
                      <h2 class="card-title">Brewery Central</h2>
                      <address class="card-location">
                        <span class="location">12345</span>
                        <span class="location-detail">Pittsburgh, PA</span>
                      </address>
                    </div>
                    <button type="button" class="follow-btn" aria-label="Follow Brewery Central">Follow</button>
                  </div>
                  <hr class="card-divider">
                  <section class="card-content">
                    <p>Crafting exceptional, small-batch beers since 2015, we're dedicated to quality, creativity, and community. Stop by our taproom to enjoy fresh pours straight from the source and explore our brewery with guided tours!</p>
                  </section>
                </a>
              </article>

              <!-- Card 2: Farmer -->
              <article class="card small clickable-card" data-testid="farm-card">
                <a href="vendors/sunny-acres/index.html" class="card-link" aria-label="View Sunny Acres Farm">
                  <header class="card-header-row">
                    <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                    <span class="subcategory-tag">Small Farm</span>
                  </header>
                  <figure class="card-image">
                    <img src="https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Sunny Acres Farm">
                  </figure>
                  <div class="card-header-actions">
                    <div class="card-title-section">
                      <h2 class="card-title">Sunny Acres Farm</h2>
                      <address class="card-location">
                        <span class="location">15235</span>
                        <span class="location-detail">Boston, MA</span>
                      </address>
                    </div>
                    <button type="button" class="follow-btn" aria-label="Follow Sunny Acres Farm">Follow</button>
                  </div>
                  <hr class="card-divider">
                  <section class="card-content">
                    <p>Fresh organic vegetables, free-range eggs, and seasonal fruitsâ€”all grown with care using sustainable farming practices. Visit our charming farm stand to pick up the latest harvest, or join our CSA program for weekly boxes filled with the very best of the season!</p>
                  </section>
                </a>
              </article>

              <!-- Card 2: Artisan -->
              <article class="card small clickable-card" data-testid="pottery-card">
                <a href="vendors/mountain-pottery/index.html" class="card-link" aria-label="View Mountain Pottery Studio">
                  <header class="card-header-row">
                    <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                    <span class="subcategory-tag">Artisan</span>
                  </header>
                  <figure class="card-image">
                    <img src="https://images.unsplash.com/photo-1523475472560-d2df97ec485c?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Artist painting detailed designs onto a handcrafted ceramic vase">
                  </figure>
                  <div class="card-header-actions">
                    <div class="card-title-section">
                      <h2 class="card-title">Mountain Pottery Studio</h2>
                      <address class="card-location">
                        <span class="location">03860</span>
                        <span class="location-detail">Portland, OR</span>
                      </address>
                    </div>
                    <button type="button" class="follow-btn" aria-label="Follow Mountain Pottery Studio">Follow</button>
                  </div>
                  <hr class="card-divider">
                  <section class="card-content">
                    <p>Handcrafted ceramic pieces made with locally sourced clay, each created with care and attention to detail. Custom orders are always welcome! Visit our studio to browse our latest work and take part in our pottery classes and hands-on workshops.</p>
                  </section>
                </a>
              </article>

              <!-- Card 3: Event -->
              <article class="card small clickable-card" data-testid="music-festival-card">
                <a href="events/summer-music-festival/index.html" class="card-link" aria-label="View Summer Music Festival">
                  <header class="card-header-row">
                    <span class="type-badge event" aria-label="Event type">EVENT</span>
                    <span class="subcategory-tag">Music Festival</span>
                  </header>
                  <figure class="card-image">
                    <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Summer Music Festival">
                  </figure>
                  <div class="card-header-actions">
                    <div class="card-title-section">
                      <h2 class="card-title">Summer Music Festival</h2>
                      <address class="card-location">
                        <span class="location">03894</span>
                        <span class="location-detail">Austin, TX</span>
                      </address>
                    </div>
                    <button type="button" class="follow-btn" aria-label="Follow Summer Music Festival">Follow</button>
                  </div>
                  <hr class="card-divider">
                  <section class="card-content">
                    <p>Three days of local bands, food trucks, and artisan vendors. Family-friendly activities and live music all weekend long!</p>
                  </section>
                </a>
              </article>

              <!-- Card 4: Beer Tasting Event -->
              <article class="card small clickable-card" data-testid="beer-event-card">
                <a href="events/beer/index.html" class="card-link" aria-label="View Craft Beer Tasting Event">
                  <header class="card-header-row">
                    <span class="type-badge event" aria-label="Event type">EVENT</span>
                    <span class="subcategory-tag">Beer Tasting</span>
                  </header>
                  <figure class="card-image">
                    <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Craft Beer Tasting Event">
                  </figure>
                  <div class="card-header-actions">
                    <div class="card-title-section">
                      <h2 class="card-title">Craft Beer Tasting Event</h2>
                      <address class="card-location">
                        <span class="location">12345</span>
                        <span class="location-detail">Pittsburgh, PA</span>
                      </address>
                    </div>
                    <button type="button" class="follow-btn" aria-label="Follow Craft Beer Tasting Event">Follow</button>
                  </div>
                  <hr class="card-divider">
                  <section class="card-content">
                    <p>Join us for an exclusive craft beer tasting featuring local breweries. Sample unique brews, meet the brewers, and enjoy live music!</p>
                  </section>
                </a>
              </article>

              <!-- Card 5: Craftsman -->
              <article class="card small" data-testid="woodworks-card">
                <header class="card-header-row">
                  <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                  <span class="subcategory-tag">Craftsmen</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Riverside Woodworks">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Riverside Woodworks</h2>
                    <address class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Riverside Woodworks">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Custom furniture and home decor made from reclaimed wood. Each piece tells a story of local history and craftsmanship.</p>
                </section>
              </article>

              <!-- Card 5: Class -->
              <article class="card small" data-testid="cooking-class-card">
                <header class="card-header-row">
                  <span class="type-badge event" aria-label="Event type">EVENT</span>
                  <span class="subcategory-tag">Class</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Farm-to-Table Cooking Class">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Farm-to-Table Cooking Class</h2>
                    <address class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Farm-to-Table Cooking Class">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Learn to cook with fresh, local ingredients! Chef Maria will teach you seasonal recipes using produce from nearby farms.</p>
                </section>
              </article>

              <!-- Card 6: Farmer -->
              <article class="card small" data-testid="apiary-card">
                <header class="card-header-row">
                  <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                  <span class="subcategory-tag">Small Farm</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Honey Hill Apiary">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Honey Hill Apiary</h2>
                    <address class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Honey Hill Apiary">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Raw, unfiltered honey from our local bee colonies. Also offering beekeeping classes and hive tours for the whole family!</p>
                </section>
              </article>

              <!-- Card 7: Fair -->
              <article class="card small" data-testid="craft-fair-card">
                <header class="card-header-row">
                  <span class="type-badge event" aria-label="Event type">EVENT</span>
                  <span class="subcategory-tag">Craft Fair</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="County Craft Fair">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">County Craft Fair</h2>
                    <address class="card-location">
                      <span class="location">03894</span>
                      <span class="location-detail">Austin, TX</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow County Craft Fair">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Over 50 local artisans showcasing handmade goods, jewelry, pottery, textiles, and more. Food trucks and live demonstrations!</p>
                </section>
              </article>

              <!-- Card 8: Artisan -->
              <article class="card small" data-testid="jewelry-card">
                <header class="card-header-row">
                  <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                  <span class="subcategory-tag">Artisan</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Silver Moon Jewelry">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Silver Moon Jewelry</h2>
                    <address class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Silver Moon Jewelry">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Handcrafted sterling silver jewelry inspired by nature. Custom pieces available. Visit our studio or shop online!</p>
                </section>
              </article>

              <!-- Card 9: Farmer -->
              <article class="card small" data-testid="organic-farm-card">
                <header class="card-header-row">
                  <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                  <span class="subcategory-tag">Small Farm</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Green Valley Organic Farm">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Green Valley Organic Farm</h2>
                    <address class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Green Valley Organic Farm">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Certified organic vegetables, herbs, and flowers. Pick-your-own berries in season. Farm tours available by appointment.</p>
                </section>
              </article>

              <!-- Card 10: Class -->
              <article class="card small" data-testid="woodworking-class-card">
                <header class="card-header-row">
                  <span class="type-badge event" aria-label="Event type">EVENT</span>
                  <span class="subcategory-tag">Workshop</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Beginner Woodworking Workshop">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Beginner Woodworking Workshop</h2>
                    <address class="card-location">
                      <span class="location">03860</span>
                      <span class="location-detail">Portland, OR</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Beginner Woodworking Workshop">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Learn basic woodworking skills and create your own cutting board! All tools and materials provided. Perfect for beginners.</p>
                </section>
              </article>

              <!-- Card 11: Artisan -->
              <article class="card small" data-testid="textiles-card">
                <header class="card-header-row">
                  <span class="type-badge vendor" aria-label="Vendor type">VENDOR</span>
                  <span class="subcategory-tag">Artisan</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Heritage Textiles">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Heritage Textiles</h2>
                    <address class="card-location">
                      <span class="location">03894</span>
                      <span class="location-detail">Austin, TX</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Heritage Textiles">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Handwoven textiles using traditional techniques. Scarves, blankets, and home decor items. Custom orders welcome!</p>
                </section>
              </article>

              <!-- Card 12: Event -->
              <article class="card small" data-testid="farmers-market-card">
                <header class="card-header-row">
                  <span class="type-badge event" aria-label="Event type">EVENT</span>
                  <span class="subcategory-tag">Market</span>
                </header>
                <figure class="card-image">
                  <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=300&fit=crop" class="responsive" loading="lazy" alt="Farmers Market Opening Day">
                </figure>
                <div class="card-header-actions">
                  <div class="card-title-section">
                    <h2 class="card-title">Farmers Market Opening Day</h2>
                    <address class="card-location">
                      <span class="location">15235</span>
                      <span class="location-detail">Boston, MA</span>
                    </address>
                  </div>
                  <button type="button" class="follow-btn" aria-label="Follow Farmers Market Opening Day">Follow</button>
                </div>
                <hr class="card-divider">
                <section class="card-content">
                  <p>Join us for the opening day of our weekly farmers market! Fresh produce, local vendors, live music, and family activities.</p>
                </section>
              </article>

            </section>
          </div>
        </div>
      </div>
    </main>

    <script type="module" src="https://cdn.jsdelivr.net/npm/beercss@3.12.13/dist/cdn/beer.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/material-dynamic-colors@1.1.2/dist/cdn/material-dynamic-colors.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
      // Theme Toggle Functionality
      (function() {
        // Get stored theme or default to light
        const storedTheme = localStorage.getItem('theme') || 'light';
        
        // Apply theme on page load
        document.body.classList.remove('dark', 'light');
        document.body.classList.add(storedTheme);
        
        // Create toggle button
        const toggleButton = document.createElement('button');
        toggleButton.className = 'theme-toggle circle';
        toggleButton.setAttribute('aria-label', 'Toggle theme');
        toggleButton.innerHTML = '<i>' + (storedTheme === 'light' ? 'dark_mode' : 'light_mode') + '</i>';
        
        // Add click handler
        toggleButton.addEventListener('click', function() {
          const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          
          document.body.classList.remove('dark', 'light');
          document.body.classList.add(newTheme);
          localStorage.setItem('theme', newTheme);
          
          toggleButton.querySelector('i').textContent = newTheme === 'light' ? 'dark_mode' : 'light_mode';
        });
        
        document.body.appendChild(toggleButton);
      })();
      
      // Move card elements to match brewery card layout on desktop
      function rearrangeCardLayout() {
        if (window.innerWidth < 769) {
          // Reset on mobile
          document.querySelectorAll('.feed-container .card.small:not([data-desktop-layout="brewery"])').forEach(card => {
            delete card.dataset.rearranged;
            const titleClone = card.querySelector('.card-header-row .card-title');
            if (titleClone) titleClone.remove();
            const titleEl = card.querySelector('.card-header-actions .card-title');
            if (titleEl) titleEl.style.display = '';
          });
          return;
        }
        
        const cards = document.querySelectorAll('.feed-container .card.small:not([data-desktop-layout="brewery"])');
        cards.forEach(card => {
          if (card.dataset.rearranged) return; // Already rearranged
          
          const headerRow = card.querySelector('.card-header-row');
          const titleEl = card.querySelector('.card-title');
          const typeBadge = card.querySelector('.type-badge');
          const subcategoryTag = card.querySelector('.subcategory-tag');
          
          if (headerRow && titleEl && !headerRow.querySelector('.card-title')) {
            // Clone title and move to header row
            const titleClone = titleEl.cloneNode(true);
            headerRow.insertBefore(titleClone, headerRow.firstChild);
          }
          
          // Hide original title in title section
          if (titleEl) titleEl.style.display = 'none';
          
          // Move type badge and subcategory to right side of header row
          if (headerRow && typeBadge && subcategoryTag) {
            const typeContainer = document.createElement('span');
            typeContainer.style.fontSize = '0.8rem';
            typeContainer.style.color = 'var(--on-surface-variant)';
            typeContainer.textContent = typeBadge.textContent.trim() + ' ' + subcategoryTag.textContent.trim();
            headerRow.appendChild(typeContainer);
          }
          
          card.dataset.rearranged = 'true';
        });
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', rearrangeCardLayout);
      } else {
        rearrangeCardLayout();
      }
      
      window.addEventListener('resize', rearrangeCardLayout);
      
      // Handle filter toggle button
      (function() {
        const filterToggle = document.querySelector('.filter-toggle-btn');
        const filterDropdown = document.getElementById('filterDropdown');
        
        if (filterToggle && filterDropdown) {
          filterToggle.addEventListener('click', function() {
            const isExpanded = filterDropdown.classList.toggle('show');
            filterToggle.setAttribute('aria-expanded', isExpanded);
          });
        }
      })();
      
      // Handle feed menu button
      (function() {
        const feedMenuBtn = document.querySelector('.feed-menu-btn');
        const feedMenu = document.getElementById('searchFeedMenu');
        
        if (feedMenuBtn && feedMenu) {
          feedMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            const isExpanded = feedMenu.classList.toggle('active');
            feedMenuBtn.setAttribute('aria-expanded', isExpanded);
          });
          
          // Close menu when clicking outside
          document.addEventListener('click', function(e) {
            if (!feedMenuBtn.contains(e.target) && !feedMenu.contains(e.target)) {
              feedMenu.classList.remove('active');
              feedMenuBtn.setAttribute('aria-expanded', 'false');
            }
          });
          
          // Close menu when clicking menu item
          const menuItem = feedMenu.querySelector('.menu-item');
          if (menuItem) {
            menuItem.addEventListener('click', function(e) {
              e.preventDefault();
              feedMenu.classList.remove('active');
              feedMenuBtn.setAttribute('aria-expanded', 'false');
            });
          }
        }
      })();
      
      // Handle card links (prevent double navigation)
      (function() {
        document.querySelectorAll('.card-link').forEach(link => {
          link.addEventListener('click', function(e) {
            // Allow button clicks to work independently
            if (e.target.closest('button')) {
              e.stopPropagation();
              e.preventDefault();
            }
          });
        });
      })();
      
      // Hide header and logo when scrolling down
      (function() {
        let lastScrollTop = 0;
        const scrollThreshold = 10; // Minimum scroll distance to trigger hide/show
        const topHeader = document.querySelector('header.top-header');
        const siteLogo = document.querySelector('.site-logo');
        const mainContent = document.querySelector('main.responsive') || document.querySelector('main');
        
        let ticking = false;
        
        function handleScroll() {
          const scrollTop = mainContent ? mainContent.scrollTop : (window.pageYOffset || document.documentElement.scrollTop);
          
          if (Math.abs(lastScrollTop - scrollTop) < scrollThreshold) {
            ticking = false;
            return;
          }
          
          if (scrollTop > lastScrollTop && scrollTop > scrollThreshold) {
            // Scrolling down - hide header and logo
            if (topHeader) topHeader.classList.add('header-hidden');
            if (siteLogo) siteLogo.classList.add('logo-hidden');
          } else if (scrollTop < lastScrollTop) {
            // Scrolling up - show header and logo
            if (topHeader) topHeader.classList.remove('header-hidden');
            if (siteLogo) siteLogo.classList.remove('logo-hidden');
          }
          
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; // For mobile or negative scroll
          ticking = false;
        }
        
        function onScroll() {
          if (!ticking) {
            window.requestAnimationFrame(handleScroll);
            ticking = true;
          }
        }
        
        // Listen to scroll events on main content or window
        if (mainContent) {
          mainContent.addEventListener('scroll', onScroll, { passive: true });
        }
        window.addEventListener('scroll', onScroll, { passive: true });
      })();
      
      // Update card layout rearrangement for new semantic structure
      (function() {
        function rearrangeCardLayout() {
          if (window.innerWidth < 769) {
            // Reset on mobile
            document.querySelectorAll('section.feed-container article.card.small:not([data-desktop-layout="brewery"])').forEach(card => {
              delete card.dataset.rearranged;
              const titleClone = card.querySelector('.card-header-row .card-title');
              if (titleClone) titleClone.remove();
              const titleEl = card.querySelector('.card-header-actions .card-title');
              if (titleEl) titleEl.style.display = '';
            });
            return;
          }
          
          const cards = document.querySelectorAll('section.feed-container article.card.small:not([data-desktop-layout="brewery"])');
          cards.forEach(card => {
            if (card.dataset.rearranged) return; // Already rearranged
            
            const headerRow = card.querySelector('.card-header-row');
            const titleEl = card.querySelector('.card-title');
            const typeBadge = card.querySelector('.type-badge');
            const subcategoryTag = card.querySelector('.subcategory-tag');
            
            if (headerRow && titleEl && !headerRow.querySelector('.card-title')) {
              // Clone title and move to header row
              const titleClone = titleEl.cloneNode(true);
              headerRow.insertBefore(titleClone, headerRow.firstChild);
            }
            
            // Hide original title in title section
            if (titleEl) titleEl.style.display = 'none';
            
            // Move type badge and subcategory to right side of header row
            if (headerRow && typeBadge && subcategoryTag) {
              const typeContainer = document.createElement('span');
              typeContainer.style.fontSize = '0.8rem';
              typeContainer.style.color = 'var(--on-surface-variant)';
              typeContainer.textContent = typeBadge.textContent.trim() + ' ' + subcategoryTag.textContent.trim();
              headerRow.appendChild(typeContainer);
            }
            
            card.dataset.rearranged = 'true';
          });
        }
        
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', rearrangeCardLayout);
        } else {
          rearrangeCardLayout();
        }
        
        window.addEventListener('resize', rearrangeCardLayout);
      })();
    </script>
  </body>
</html>
